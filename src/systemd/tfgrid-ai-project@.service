[Unit]
Description=TFGrid AI Agent - Project %i
After=network.target

[Service]
Type=forking
User=developer
Group=developer
WorkingDirectory=/home/developer/code/tfgrid-ai-agent-projects/%i
ExecStart=/bin/bash -c '/opt/ai-agent/scripts/agent-loop.sh /home/developer/code/tfgrid-ai-agent-projects/%i >> /home/developer/code/tfgrid-ai-agent-projects/%i/agent-output.log 2>> /home/developer/code/tfgrid-ai-agent-projects/%i/agent-errors.log &'
Restart=on-failure
RestartSec=10
StandardOutput=append:/home/developer/code/tfgrid-ai-agent-projects/%i/agent-output.log
StandardError=append:/home/developer/code/tfgrid-ai-agent-projects/%i/agent-errors.log

# Resource limits
MemoryMax=2G
CPUQuota=150%

# Environment
Environment="PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin"
Environment="HOME=/home/developer"

[Install]
WantedBy=multi-user.target
